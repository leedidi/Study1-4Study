SELECT USER
FROM DUAL;
--==>> SCOTT

--○ 생성한 함수(FN_GENDER())가 제대로 작동하는지의 여부 확인
SELECT NAME, SSN, FN_GENDER(SSN)"함수호출결과"
FROM TBL_INSA;
--==>>
/*
홍길동	771212-1022432	남자
이순신	801007-1544236	남자
이순애	770922-2312547	여자
김정훈	790304-1788896	남자
한석봉	811112-1566789	남자
이기자	780505-2978541	여자
장인철	780506-1625148	남자
김영년	821011-2362514	여자
나윤균	810810-1552147	남자
김종서	751010-1122233	남자
유관순	801010-2987897	여자
정한국	760909-1333333	남자
조미숙	790102-2777777	여자
황진이	810707-2574812	여자
이현숙	800606-2954687	여자
이상헌	781010-1666678	남자
엄용수	820507-1452365	남자
이성길	801028-1849534	남자
박문수	780710-1985632	남자
유영희	800304-2741258	여자
홍길남	801010-1111111	남자
이영숙	800501-2312456	여자
김인수	731211-1214576	남자
김말자	830225-2633334	여자
우재옥	801103-1654442	남자
김숙남	810907-2015457	여자
김영길	801216-1898752	남자
이남신	810101-1010101	남자
김말숙	800301-2020202	여자
정정해	790210-2101010	여자
지재환	771115-1687988	남자
심심해	810206-2222222	여자
김미나	780505-2999999	여자
이정석	820505-1325468	남자
정영희	831010-2153252	여자
이재영	701126-2852147	여자
최석규	770129-1456987	남자
손인수	791009-2321456	여자
고순정	800504-2000032	여자
박세열	790509-1635214	남자
문길수	721217-1951357	남자
채정희	810709-2000054	여자
양미옥	830504-2471523	여자
지수환	820305-1475286	남자
홍원신	690906-1985214	남자
허경운	760105-1458752	남자
산마루	780505-1234567	남자
이기상	790604-1415141	남자
이미성	830908-2456548	여자
이미인	810403-2828287	여자
권영미	790303-2155554	여자
권옥경	820406-2000456	여자
김싱식	800715-1313131	남자
정상호	810705-1212141	남자
정한나	820506-2425153	여자
전용재	800605-1456987	남자
이미경	780406-2003214	여자
김신제	800709-1321456	남자
임수봉	810809-2121244	여자
김신애	810809-2111111	여자
*/

--○ 생성한 함수(FN_POW())가 제대로 작동하는지의 여부 확인
SELECT FN_POW(10,3)"함수호출결과"
FROM DUAL;
--==>> 1000

SELECT FN_POW(2,8)"함수호출결과"
FROM DUAL;
--==>> 256

SELECT FN_POW(3,3)"함수호출결과"
FROM DUAL;
--==>> 27


-- 프로시저 관련 실습

-- 실습 테이블 생성(TBL_STUDENTS)

-- 실습 테이블 생성(TBL_STUDENTS)
CREATE TABLE TBL_STUDENTS
( ID    VARCHAR2(10)
, NAME  VARCHAR2(40)
, TEL   VARCHAR2(20)
, ADDR  VARCHAR2(100)
);
--==>> Table TBL_STUDENTS이(가) 생성되었습니다.
--@ PLSQL에서는 블럭잡아서 실행해야하는거 주의...! 아니고 전체해버리면 그 페이지 전체 입력되는거 어그러짐
--@ 테이블 등 윗부분 다시 실행해야함!

-- 실습 테이블 생성
CREATE TABLE TBL_IDPW
( ID    VARCHAR2(10)
, PW    VARCHAR2(20)
, CONSTRAINT IDPW_ID_PK PRIMARY KEY(ID)
);
--==>> Table TBL_IDPW이(가) 생성되었습니다.

-- 두 테이블에 데이터 입력
INSERT INTO TBL_STUDENTS(ID, NAME, TEL, ADDR)
VALUES('superman', '손범석', '010-1111-1111', '서울 강남구...');
INSERT INTO TBL_IDPW(ID, PW)
VALUES('superman', 'java006$');
--==>> 1 행 이(가) 삽입되었습니다. *2

SELECT *
FROM TBL_STUDENTS;
--==>> superman	손범석	010-1111-1111	서울 강남구...

SELECT *
FROM TBL_IDPW;
--==>> superman	java006$

-- 위의 업무를 프로시저(INSERT 프로시저, 입력 프로시저)를 생성하게 되면
EXEC PRC_STUDENTS_INSERT('batman', 'java006$', '송해덕', '010-2222-2222', '경기도 고양시');
-- 이와 같은 구문 한 줄로 양쪽 테이블에 데이터를 모두 제대로 입력할 수 있다.


DESC TBL_STUDENTS;
DESC TBL_IDPW;

--○ 생성한 프로시저(PRC_STUDENTS_INSERT()) 가 제대로 작동하는지의 여부 확인
--   → 프로시저 호출
EXEC PRC_STUDENTS_INSERT('batman', 'java006$', '송해덕', '010-2222-2222', '경기도 고양시');
--==>> PL/SQL 프로시저가 성공적으로 완료되었습니다.


SELECT *
FROM TBL_STUDENTS;
--==>>
/*
superman	손범석	010-1111-1111	서울 강남구...
batman	송해덕	010-2222-2222	경기도 고양시
*/

SELECT *
FROM TBL_IDPW;
--==>>
/*
superman	java006$
batman	java006$
*/
-->>> 다시 확인,,,,^^,,,,, -> 확인 완료!
--@ 스펠링 주의!!!! 스펠링 꼭 확인,,,,^^!!

--○ 학번, 이름, 국어점수, 영어점수, 수학점수 데이터를
--   입력받을 수 있는 실습 테이블 생성(TBL_SUNGJUK)
CREATE TABLE TBL_SUNGJUK
( HAKBUN    NUMBER
, NAME      VARCHAR2(40)
, KOR       NUMBER(3)
, ENG       NUMBER(3)
, MAT       NUMBER(3)
, CONSTRAINT SUNGJUK_HAKBUN_PK PRIMARY KEY(HAKBUN)
);
--==>> Table TBL_SUNGJUK이(가) 생성되었습니다.


--@ 기존 컬럼을 통해 얻어낼수 있는 결과물은 절대로 컬럼화시키면 안 됨!!
--@ EX> 총점, 평균....

--○ 생성된 테이블에 컬럼 구조 추가
--   (총점→TOT, 평균→AVG, 등급→GRADE)
ALTER TABLE TBL_SUNGJUK
ADD( TOT NUMBER(3), AVG NUMBER(4,1), GRADE CHAR);
--==>> Table TBL_SUNGJUK이(가) 변경되었습니다.

-- ※ 여기서 추가한 컬럼에 대한 항목들은
--    프로시저 실습을 위해 추가한 것일 뿐
--    실제 테이블 구조에 적합하지도, 바람직하지도 않은 내용이다.

--○ 변경된 테이블의 구조 확인
DESC TBL_SUNGJUK;
--==>>
/*
이름     널?       유형           
------ -------- ------------ 
HAKBUN NOT NULL NUMBER       
NAME            VARCHAR2(40) 
KOR             NUMBER(3)    
ENG             NUMBER(3)    
MAT             NUMBER(3)    
TOT             NUMBER(3)    
AVG             NUMBER(4,1)  
GRADE           CHAR(1)      
*/

--○ 생성한 프로시저(PRC_SUNGJUK_INSERT()) 가 제대로 작동하는지의 여부 확인
--   → 프로시저 호출
EXEC PRC_SUNGJUK_INSERT(1, '김진희', 90, 80, 70);
--==>> PL/SQL 프로시저가 성공적으로 완료되었습니다.
-- STUDENT에 넣어버렸는데,,,^^ㅠ 이따 삭제해 보기 -> 삭제 완료!

SELECT *
FROM TBL_SUNGJUK;
--==>> 1	김진희	90	80	70	240	80	B

EXEC PRC_SUNGJUK_INSERT(2, '김소연', 98, 88, 77);
--==>> PL/SQL 프로시저가 성공적으로 완료되었습니다.

SELECT *
FROM TBL_SUNGJUK;
--==>>
/*
1	김진희	90	80	70	240	80	    B
2	김소연	98	88	77	263	87.7	B
*/

/*
-- 시험해보기...
EXEC PRC_SUNGJUK_UPDATE(2, 100, 100, 100);
--==>>
1	김진희	90	80	70	240	80	B
2	김소연	100	100	100	300	100	A
*/

--○ 생성한 프로시저(PRC_SUNGJUK_INSERT()) 가 제대로 작동하는지의 여부 확인
--   → 프로시저 호출
EXEC PRC_SUNGJUK_UPDATE(2, 100, 100, 100);
--==>> PL/SQL 프로시저가 성공적으로 완료되었습니다.

SELECT *
FROM TBL_SUNGJUK;
--==>>
/*
1	김진희	90	80	70	240	80	B
2	김소연	100	100	100	300	100	A
*/

EXEC PRC_SUNGJUK_UPDATE(1, 55, 66, 77);
--==>> PL/SQL 프로시저가 성공적으로 완료되었습니다.

SELECT *
FROM TBL_SUNGJUK;
--==>>
/*
1	김진희	55	66	77	198	66	D
2	김소연	100	100	100	300	100	A
*/

SELECT *
FROM TBL_STUDENTS;

SELECT *
FROM TBL_IDPW;

--◈ 잘못 입력한 행 삭제
/*
DELETE
FROM TBL_STUDENTS
WHERE ID='1';

DELETE
FROM TBL_IDPW
WHERE ID='1';
*/

--◈ 내가 작성한 코드 확인
/*
DESC TBL_STUDENTS;

EXEC PRC_STUDENTS_UPDATE('superman', 'java006$', '010-9999-9999', '인천');
--==>> PL/SQL 프로시저가 성공적으로 완료되었습니다.

SELECT *
FROM TBL_STUDENTS;
--==>> superman	손범석	010-9999-9999	인천
*/

/*
SELECT I.ID, I.PW, S.TEL, S.ADDR
FROM TBL_IDPW I JOIN TBL_STUDETS S
ON I.ID = S.ID;
*/
--> 실행안댐 확인해보기

SELECT I.ID, I.PW, S.TEL, S.ADDR
FROM TBL_IDPW I JOIN TBL_STUDENTS S
ON I.ID = S.ID;
--> 실행가능!

(SELECT I.ID, I.PW, S.TEL, S.ADDR
FROM TBL_IDPW I JOIN TBL_STUDENTS S
ON I.ID = S.ID) T;


--○ 프로시저 호출 전에 기존 데이터 확인

SELECT *
FROM TBL_STUDENTS;
--==>>
/*
superman	손범석	010-1111-1111	서울 강남구...
batman	    송해덕	010-2222-2222	경기도 고양시
*/

SELECT *
FROM TBL_IDPW;
--==>>
/*
superman	java006$
batman	    java006$
*/

--○ 생성한 프로시저(PRC_SUNGJUK_INSERT()) 가 제대로 작동하는지의 여부 확인
--   → 프로시저 호출
EXEC PRC_STUDENTS_UPDATE('superman', 'java001', '010-9999-9999', '인천')
--> 패스워드 맞지 않음
--==>> PL/SQL 프로시저가 성공적으로 완료되었습니다.

SELECT *
FROM TBL_STUDENTS;
--==>>
/*
superman	손범석	010-1111-1111	서울 강남구...
batman	    송해덕	010-2222-2222	경기도 고양시
*/

EXEC PRC_STUDENTS_UPDATE('superman', 'java006$', '010-9999-9999', '인천')
--> 유효한 패스워드
--==>> PL/SQL 프로시저가 성공적으로 완료되었습니다.

SELECT *
FROM TBL_STUDENTS;
--==>>
/*
superman	손범석	010-9999-9999	인천
batman	    송해덕	010-2222-2222	경기도 고양시
*/

SELECT *
FROM TBL_INSA;

DESC TBL_INSA;

--◈ 내가 작성한 코드
-- ○ 과제 1 실행결과
/*
SELECT NAME "이름", BASICPAY "기본급", SUDANG "수당", FN_PAY(BASICPAY, SUDANG) "급여"
FROM TBL_INSA;
*/
--==>>
/*
홍길동	2610000	200000	31520000
이순신	1320000	200000	16040000
이순애	2550000	160000	30760000
김정훈	1954200	170000	23620400
한석봉	1420000	160000	17200000
이기자	2265000	150000	27330000
장인철	1250000	150000	15150000
김영년	950000	145000	11545000
나윤균	840000	220400	10300400
김종서	2540000	130000	30610000
유관순	1020000	140000	12380000
정한국	880000	114000	10674000
조미숙	1601000	103000	19315000
황진이	1100000	130000	13330000
이현숙	1050000	104000	12704000
이상헌	2350000	150000	28350000
엄용수	950000	210000	11610000
이성길	880000	123000	10683000
박문수	2300000	165000	27765000
유영희	880000	140000	10700000
홍길남	875000	120000	10620000
이영숙	1960000	180000	23700000
김인수	2500000	170000	30170000
김말자	1900000	170000	22970000
우재옥	1100000	160000	13360000
김숙남	1050000	150000	12750000
김영길	2340000	170000	28250000
이남신	892000	110000	10814000
김말숙	920000	124000	11164000
정정해	2304000	124000	27772000
지재환	2450000	160000	29560000
심심해	880000	108000	10668000
김미나	1020000	104000	12344000
이정석	1100000	160000	13360000
정영희	1050000	140000	12740000
이재영	960400	190000	11714800
최석규	2350000	187000	28387000
손인수	2000000	150000	24150000
고순정	2010000	160000	24280000
박세열	2100000	130000	25330000
문길수	2300000	150000	27750000
채정희	1020000	200000	12440000
양미옥	1100000	210000	13410000
지수환	1060000	220000	12940000
홍원신	960000	152000	11672000
허경운	2650000	150000	31950000
산마루	2100000	112000	25312000
이기상	2050000	106000	24706000
이미성	1300000	130000	15730000
이미인	1950000	103000	23503000
권영미	2260000	104000	27224000
권옥경	1020000	105000	12345000
김싱식	960000	108000	11628000
정상호	980000	114000	11874000
정한나	1000000	104000	12104000
전용재	1950000	200000	23600000
이미경	2520000	160000	30400000
김신제	1950000	180000	23580000
임수봉	890000	102000	10782000
김신애	900000	102000	10902000
*/

-- ○ 과제 2 실행결과
/*
SELECT IBSADATE "입사년도"
    , EXTRACT(YEAR FROM IBSADATE) "입사년만"
    , EXTRACT(YEAR FROM SYSDATE) - EXTRACT(YEAR FROM IBSADATE) "근무년도" 
    
    , EXTRACT(MONTH FROM IBSADATE) "입사년만"
    , EXTRACT(MONTH FROM SYSDATE) - EXTRACT(MONTH FROM IBSADATE) "근무년도" 
FROM TBL_INSA;

SELECT IBSADATE "입사년도"
    , TRUNC((SYSDATE - IBSADATE)/365, 1)
FROM TBL_INSA;
*/

SELECT NAME "이름", IBSADATE "입사일", SYSDATE "금일", FN_WORKYEAR(IBSADATE) "근무년수"
FROM TBL_INSA;
--==>>
/*
홍길동	1998-10-11	2021-09-15	22.9
이순신	2000-11-29	2021-09-15	20.8
이순애	1999-02-25	2021-09-15	22.5
김정훈	2000-10-01	2021-09-15	20.9
한석봉	2004-08-13	2021-09-15	17.1
이기자	2002-02-11	2021-09-15	19.6
장인철	1998-03-16	2021-09-15	23.5
김영년	2002-04-30	2021-09-15	19.3
나윤균	2003-10-10	2021-09-15	17.9
김종서	1997-08-08	2021-09-15	24.1
유관순	2000-07-07	2021-09-15	21.2
정한국	1999-10-16	2021-09-15	21.9
조미숙	1998-06-07	2021-09-15	23.2
황진이	2002-02-15	2021-09-15	19.5
이현숙	1999-07-26	2021-09-15	22.1
이상헌	2001-11-29	2021-09-15	19.8
엄용수	2000-08-28	2021-09-15	21
이성길	2004-08-08	2021-09-15	17.1
박문수	1999-12-10	2021-09-15	21.7
유영희	2003-10-10	2021-09-15	17.9
홍길남	2001-09-07	2021-09-15	20
이영숙	2003-02-25	2021-09-15	18.5
김인수	1995-02-23	2021-09-15	26.5
김말자	1999-08-28	2021-09-15	22
우재옥	2000-10-01	2021-09-15	20.9
김숙남	2002-08-28	2021-09-15	19
김영길	2000-10-18	2021-09-15	20.9
이남신	2001-09-07	2021-09-15	20
김말숙	2000-09-08	2021-09-15	21
정정해	1999-10-17	2021-09-15	21.9
지재환	2001-01-21	2021-09-15	20.6
심심해	2000-05-05	2021-09-15	21.3
김미나	1998-06-07	2021-09-15	23.2
이정석	2005-09-26	2021-09-15	15.9
정영희	2002-05-16	2021-09-15	19.3
이재영	2003-08-10	2021-09-15	18.1
최석규	1998-10-15	2021-09-15	22.9
손인수	1999-11-15	2021-09-15	21.8
고순정	2003-12-28	2021-09-15	17.7
박세열	2000-09-10	2021-09-15	21
문길수	2001-12-10	2021-09-15	19.7
채정희	2003-10-17	2021-09-15	17.9
양미옥	2003-09-24	2021-09-15	17.9
지수환	2004-01-21	2021-09-15	17.6
홍원신	2003-03-16	2021-09-15	18.5
허경운	1999-05-04	2021-09-15	22.3
산마루	2001-07-15	2021-09-15	20.1
이기상	2001-06-07	2021-09-15	20.2
이미성	2000-04-07	2021-09-15	21.4
이미인	2003-06-07	2021-09-15	18.2
권영미	2000-06-04	2021-09-15	21.2
권옥경	2000-10-10	2021-09-15	20.9
김싱식	1999-12-12	2021-09-15	21.7
정상호	1999-10-16	2021-09-15	21.9
정한나	2004-06-07	2021-09-15	17.2
전용재	2004-08-13	2021-09-15	17.1
이미경	1998-02-11	2021-09-15	23.6
김신제	2003-08-08	2021-09-15	18.1
임수봉	2001-10-10	2021-09-15	19.9
김신애	2001-10-10	2021-09-15	19.9
*/